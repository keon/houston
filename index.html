<!doctype html>
<html>
<head>
	<title>Houston</title>
	<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="/style.css">
	<style>
      * { margin: 0; padding: 0; box-sizing: border-box; }
      body { font: 13px Helvetica, Arial; }
      form { border: 1px solid #eee; padding: 3px; position: fixed; bottom: 0; width: 100%; }
      form input { border: 0; padding: 10px; width: 90%; margin-right: .5%; }
      form button { width: 9%; background: rgb(130, 224, 255); border: none; padding: 10px; }
      #messages { list-style-type: none; margin: 0; padding: 0; }
      #messages li { padding: 1px 10px; }
      /*#messages li:nth-child(odd) { background: #eee; }*/
	</style>
</head>
<body>
	<h1 style="text-align:center;color:white;">Chart test</h1>
	<div class="row" style="margin:20px !important">
		<div class="col-lg-12">
			<div id="container1" style="min-width: 310px; height: 300px; margin: 0 auto"></div>
		</div>
		<div class="col-lg-12">
			<div id="container2" style="min-width: 310px; height: 300px; margin: 0 auto"></div>
		</div>
	</div>

	
	<div style="background-color:#fff; margin:40px; min-height:500px;" >
		<div class="row" style="margin:0px;">
		 	<ul id="messages" class="col-lg-6"></ul>
		    <form action="" class="col-lg-6">
		      <input id="m" autocomplete="off" /><button>Send</button>
		    </form>
		</div>
	</div>






	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

	<script src="https://cdn.socket.io/socket.io-1.3.5.js"></script>
	<script src="http://code.highcharts.com/highcharts.js"></script>
	<script src="http://code.highcharts.com/modules/exporting.js"></script>
	<script src="/theme.js"></script>
	<script>
		var socket = io('http://localhost:3000');
			socket.on('news', function (data) {
			console.log(data);
			socket.emit('my other event', { my: 'data' });
		});

		$('form').submit(function(){
			socket.emit('chat message', $('#m').val());
			$('#m').val('');
			return false;
		});

		$('form').submit(function(){
			socket.emit('chat message', $('#m').val());
			$('#m').val('');
			return false;
		});
			socket.on('chat message', function(msg){
			$('#messages').append($('<li>').text(msg));
		});
	    socket.on('temperatureMessage', function(data){
	    	$('#messages').append($('<li>').text("Temperature: X: " + data.x + " Y: " + data.y));
	    });
	    socket.on('data2', function(data){
	    	$('#messages').append($('<li>').text("DATA2: X: " + data.x + " Y: " + data.y));
	    });


		$(function () {
		    $(document).ready(function () {
		        Highcharts.setOptions({
		            global: {
		                useUTC: false
		            }
		        });

		        $('#container1').highcharts({
		            chart: {
		                type: 'spline',
		                animation: Highcharts.svg, // don't animate in old IE
		                marginRight: 10,
		                events: {
		                    load: function () {

		                        // set up the updating of the chart each second
		                        var series1 = this.series[0];
		                        var series2 = this.series[1];
		                        var series3 = this.series[2];
		                        socket.on('temperature', function(temperature){
		                        	console.log(temperature);
		                        	series1.addPoint([temperature.x, Number(temperature.y)], true, true);
		                        });

		                        socket.on('pressure', function(pressure){
		                        	series2.addPoint([pressure.x, Number(pressure.y)], true, true);
		                        });

		                        socket.on('sealevel', function(sealevel){
		                        	series3.addPoint([sealevel.x, Number(sealevel.y)], true, true);
		                        });

		                    }
		                }
		            },
		            title: {
		                text: 'Live random data'
		            },
		            xAxis: {
		                type: 'datetime',
		                tickPixelInterval: 100
		            },
		            yAxis: {
		                title: {
		                    text: 'Value'
		                },
		                plotLines: [{
		                    value: 0,
		                    width: 1,
		                    color: '#808080'
		                }]
		            },
		            tooltip: {
		                formatter: function () {
		                    return '<b>' + this.series.name + '</b><br/>' +
		                        Highcharts.dateFormat('%Y-%m-%d %H:%M:%S', this.x) + '<br/>' +
		                        Highcharts.numberFormat(this.y, 2);
		                }
		            },
		            legend: {
		                enabled: true
		            },
		            exporting: {
		                enabled: true
		            },
		            navigation: {
		            	enabled: true
		            },
		            series: [{
		                name: 'Temperature',
		                data: (function () {
		                    // generate an array of random data
		                    var data = [],
		                        time = (new Date()).getTime(),
		                        i;

		                    for (i = -100; i <= 0; i += 1) {
		                        data.push({
		                            x: time + i * 1000,
		                            y: Math.random()
		                        });
		                    }
		                    return data;
		                }())
		            },{
		                name: 'Pressure',
		                data: (function () {
		                    // generate an array of random data
		                    var data = [],
		                        time = (new Date()).getTime(),
		                        i;

		                    for (i = -100; i <= 0; i += 1) {
		                        data.push({
		                            x: time + i * 1000,
		                            y: Math.random()
		                        });
		                    }
		                    return data;
		                }())
		            },{
		                name: 'Sealevel',
		                data: (function () {
		                    // generate an array of random data
		                    var data = [],
		                        time = (new Date()).getTime(),
		                        i;

		                    for (i = -100; i <= 0; i += 1) {
		                        data.push({
		                            x: time + i * 1000,
		                            y: Math.random()
		                        });
		                    }
		                    return data;
		                }())
		            }

		            ]
		        });

		        $('#container2').highcharts({
		            chart: {
		                type: 'spline',
		                animation: Highcharts.svg, // don't animate in old IE
		                marginRight: 10,
		                events: {
		                    load: function () {

		                        // set up the updating of the chart each second
		                        var series1 = this.series[0];
		                        var series2 = this.series[1];
		                        // socket.on('sample1', function(sample){
		                        // 	series1.addPoint([sample.x, sample.y], true, true);
		                        // });
		                        // socket.on('sample2', function(sample){
		                        // 	series2.addPoint([sample.x, sample.y], true, true);
		                        // });
		                    }
		                }
		            },
		            title: {
		                text: 'REAL ARDUINO DATA'
		            },
		            xAxis: {
		                type: 'datetime',
		                tickPixelInterval: 100
		            },
		            yAxis: {
		                title: {
		                    text: 'Value'
		                },
		                plotLines: [{
		                    value: 0,
		                    width: 1,
		                    color: '#808080'
		                }]
		            },
		            tooltip: {
		                formatter: function () {
		                    return '<b>' + this.series.name + '</b><br/>' +
		                        Highcharts.dateFormat('%Y-%m-%d %H:%M:%S', this.x) + '<br/>' +
		                        Highcharts.numberFormat(this.y, 2);
		                }
		            },
		            legend: {
		                enabled: true
		            },
		            exporting: {
		                enabled: true
		            },
		            navigation: {
		            	enabled: true
		            },
		            series: [{
		                name: 'Sealevel',
		                data: (function () {
		                    // generate an array of random data
		                    var data = [],
		                        time = (new Date()).getTime(),
		                        i;

		                    for (i = -100; i <= 0; i += 1) {
		                        data.push({
		                            x: time + i * 1000,
		                            y: Math.random()
		                        });
		                    }
		                    return data;
		                }())
		            },{
		                name: 'Temperature',
		                data: (function () {
		                    // generate an array of random data
		                    var data = [],
		                        time = (new Date()).getTime(),
		                        i;

		                    for (i = -100; i <= 0; i += 1) {
		                        data.push({
		                            x: time + i * 1000,
		                            y: Math.random()
		                        });
		                    }
		                    return data;
		                }())
		            }

		            ]
		        });
		    });
		});

	</script>
</body>
</html>